{"version":3,"file":"index.modern.js","sources":["../src/MapPicker.tsx"],"sourcesContent":["import React, { FC } from 'react';\r\n\r\nfunction loadScript(src:string, id:string) {\r\n    const script = document.createElement('script');\r\n    script.setAttribute('async', '');\r\n    script.setAttribute('id', id);\r\n    script.src = src;\r\n    (document.querySelector('head') as any).appendChild(script);\r\n\r\n    return new Promise((resolve) => {\r\n        script.onload = () => {\r\n            resolve();\r\n        };\r\n    });\r\n  }\r\n\r\ntype Props = {\r\n    apiKey:string,\r\n    defaultLocation:{lat:number,lng:number};\r\n    onChange?(lat:number,lng:number):void;\r\n}\r\n\r\nfunction isValidLocation(lat:number, lng:number){\r\n    return Math.abs(lat) <= 90 && Math.abs(lng) <= 180;\r\n}\r\n\r\nconst MapPicker:FC<Props> = ({apiKey, defaultLocation, onChange}) => {\r\n    const loaded = React.useRef(false);\r\n    let marker = React.useRef<any>(null);\r\n\r\n    function handleChangeLocation(){\r\n        if(onChange){\r\n            var currentLocation = marker.current.getPosition();\r\n            onChange(currentLocation.lat(), currentLocation.lng());\r\n        }\r\n    }\r\n\r\n    function loadMap(){\r\n        const Google = (window as any).google;\r\n\r\n        const map = new Google.maps.Map(document.getElementById('google-map-view'), \r\n            { \r\n                center: isValidLocation(defaultLocation.lat, defaultLocation.lng) ? defaultLocation : { lat: 0, lng: 0},\r\n                zoom: 5 \r\n            });\r\n\r\n            Google.maps.event.addListener(map, 'click', function(event:any) {                \r\n                var clickedLocation = event.latLng;\r\n                if(!marker.current){\r\n                    marker.current = new Google.maps.Marker({\r\n                        position: clickedLocation,\r\n                        map: map,\r\n                        draggable: true\r\n                    });\r\n                    Google.maps.event.addListener(marker.current, 'dragend', handleChangeLocation);\r\n                } else {\r\n                    marker.current.setPosition(clickedLocation);\r\n                }\r\n\r\n                handleChangeLocation();\r\n            });\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        if (!loaded.current) {\r\n            loadScript(\r\n                'https://maps.googleapis.com/maps/api/js?libraries=places&key=' + apiKey,\r\n                'google-maps',\r\n              )\r\n              .then(loadMap);\r\n            loaded.current = true;\r\n        }\r\n\r\n    },[])  // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n   return (\r\n      <div>\r\n        <div id=\"google-map-view\" style={{width: '100%', height:'600px'}}></div>\r\n      </div>\r\n   );\r\n};\r\nexport default MapPicker;"],"names":["loadScript","src","id","script","document","createElement","setAttribute","querySelector","appendChild","Promise","resolve","onload","isValidLocation","lat","lng","Math","abs","MapPicker","apiKey","defaultLocation","onChange","loaded","React","useRef","marker","handleChangeLocation","currentLocation","current","getPosition","loadMap","Google","window","google","map","maps","Map","getElementById","center","zoom","event","addListener","clickedLocation","latLng","Marker","position","draggable","setPosition","useEffect","then","style","width","height"],"mappings":"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"}