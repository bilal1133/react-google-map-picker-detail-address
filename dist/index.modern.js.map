{"version":3,"file":"index.modern.js","sources":["../src/MapPicker.tsx"],"sourcesContent":["import React, { FC } from 'react';\r\n\r\nfunction loadScript(src:string, id:string) {\r\n    const script = document.createElement('script');\r\n    script.setAttribute('async', '');\r\n    script.setAttribute('id', id);\r\n    script.src = src;\r\n    (document.querySelector('head') as any).appendChild(script);\r\n\r\n    return new Promise((resolve) => {\r\n        script.onload = () => {\r\n            resolve();\r\n        };\r\n    });\r\n  }\r\n\r\ntype Props = {\r\n    apiKey:string,\r\n    defaultLocation:{lat:number,lng:number};\r\n    onChange?(lat:number,lng:number):void;\r\n    style?:any;\r\n    className?:string;\r\n}\r\n\r\nfunction isValidLocation(lat:number, lng:number){\r\n    return Math.abs(lat) <= 90 && Math.abs(lng) <= 180;\r\n}\r\n\r\nconst MAP_VIEW_ID = 'google-map-view-' + Math.random().toString(36).substr(2, 9);\r\n\r\nconst MapPicker:FC<Props> = ({apiKey, defaultLocation, onChange, style,className}) => {\r\n    \r\n    const loaded = React.useRef(false);\r\n    let marker = React.useRef<any>(null);\r\n\r\n    function handleChangeLocation(){\r\n        if(onChange){\r\n            var currentLocation = marker.current.getPosition();\r\n            onChange(currentLocation.lat(), currentLocation.lng());\r\n        }\r\n    }\r\n\r\n    function loadMap(){\r\n        const Google = (window as any).google;\r\n        const centerLocation = isValidLocation(defaultLocation.lat, defaultLocation.lng) ? defaultLocation : { lat: 0, lng: 0};\r\n        const map = new Google.maps.Map(document.getElementById(MAP_VIEW_ID), \r\n            { \r\n                center: centerLocation,\r\n                zoom: 5 \r\n            });\r\n\r\n            if(!marker.current){\r\n                marker.current = new Google.maps.Marker({\r\n                    position: centerLocation,\r\n                    map: map,\r\n                    draggable: true\r\n                });\r\n                Google.maps.event.addListener(marker.current, 'dragend', handleChangeLocation);\r\n            } else {\r\n                marker.current.setPosition(centerLocation);\r\n            }\r\n\r\n            Google.maps.event.addListener(map, 'click', function(event:any) {                \r\n                var clickedLocation = event.latLng;\r\n                marker.current.setPosition(clickedLocation);\r\n                handleChangeLocation();\r\n            });\r\n    }\r\n\r\n    React.useEffect(() => {\r\n        if (!loaded.current) {\r\n            loadScript(\r\n                'https://maps.googleapis.com/maps/api/js?libraries=places&key=' + apiKey,\r\n                'google-maps',\r\n              )\r\n              .then(loadMap);\r\n            loaded.current = true;\r\n        }\r\n\r\n    },[])  // eslint-disable-line react-hooks/exhaustive-deps\r\n\r\n    const componentStyle = Object.assign({width: '100%', height:'600px'}, style || {});\r\n\r\n   return (\r\n    <div id={MAP_VIEW_ID} style={componentStyle} className={className}></div>\r\n   );\r\n};\r\nexport default MapPicker;"],"names":["loadScript","src","id","script","document","createElement","setAttribute","querySelector","appendChild","Promise","resolve","onload","isValidLocation","lat","lng","Math","abs","MAP_VIEW_ID","random","toString","substr","MapPicker","apiKey","defaultLocation","onChange","style","className","loaded","React","useRef","marker","handleChangeLocation","currentLocation","current","getPosition","loadMap","Google","window","google","centerLocation","map","maps","Map","getElementById","center","zoom","Marker","position","draggable","event","addListener","setPosition","clickedLocation","latLng","useEffect","then","componentStyle","Object","assign","width","height"],"mappings":"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"}