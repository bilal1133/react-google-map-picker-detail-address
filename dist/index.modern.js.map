{"version":3,"file":"index.modern.js","sources":["../src/MapPicker.tsx"],"sourcesContent":["import React, { FC } from 'react';\n\nfunction loadScript(src:string, id:string) {\n    const script = document.createElement('script');\n    script.setAttribute('async', '');\n    script.setAttribute('id', id);\n    script.src = src;\n    (document.querySelector('head') as any).appendChild(script);\n\n    return new Promise((resolve) => {\n        script.onload = () => {\n            resolve();\n        };\n    });\n  }\n\ntype Location = {\nlat:number,\nlng:number\n}\n  \ntype Props = {\n    apiKey:string,\n    defaultLocation:Location;\n    zoom?:number;\n    onChangeLocation?(lat:number,lng:number):void;\n    onChangeZoom?(zoom:number):void;\n    style?:any;\n    className?:string;\n}\n\nfunction isValidLocation(location:Location){\n    return location && Math.abs(location.lat) <= 90 && Math.abs(location.lng) <= 180;\n}\n\nconst GOOGLE_SCRIPT_URL = 'https://maps.googleapis.com/maps/api/js?libraries=places&key=';\nconst MAP_VIEW_ID = 'google-map-view-' + Math.random().toString(36).substr(2, 9);\n\nconst MapPicker:FC<Props> = ({apiKey, defaultLocation, zoom = 7, onChangeLocation, onChangeZoom, style,className}) => {\n    \n    const map = React.useRef<any>(null);\n    const marker = React.useRef<any>(null);\n\n    function handleChangeLocation(){\n        if(onChangeLocation){\n            const currentLocation = marker.current.getPosition();\n            onChangeLocation(currentLocation.lat(), currentLocation.lng());\n        }\n    }\n\n    function handleChangeZoom(){\n        onChangeZoom && onChangeZoom(map.current.getZoom());\n    }\n\n    function loadMap(){\n        const Google = (window as any).google;\n        const validLocation = isValidLocation(defaultLocation) ? defaultLocation : { lat: 0, lng: 0};\n\n        map.current = new Google.maps.Map(document.getElementById(MAP_VIEW_ID), \n            { \n                center: validLocation,\n                zoom: zoom\n            });\n\n        if(!marker.current){\n            marker.current = new Google.maps.Marker({\n                position: validLocation,\n                map: map.current,\n                draggable: true\n            });\n            Google.maps.event.addListener(marker.current, 'dragend', handleChangeLocation);\n        } else {\n            marker.current.setPosition(validLocation);\n        }\n\n        map.current.addListener('click', function(event:any) {                \n            const clickedLocation = event.latLng;\n            \n            marker.current.setPosition(clickedLocation);\n            handleChangeLocation();\n        });\n\n        map.current.addListener('zoom_changed', handleChangeZoom);\n    }\n\n    React.useEffect(() => {\n        loadScript(GOOGLE_SCRIPT_URL + apiKey,'google-maps').then(loadMap);\n    },[])  // eslint-disable-line react-hooks/exhaustive-deps\n\n    React.useEffect(() => {\n        if (marker.current) {\n            map.current.setCenter(defaultLocation);\n            marker.current.setPosition(defaultLocation);\n        }\n    },[defaultLocation]);\n\n    React.useEffect(() => {\n        if (map.current) {\n            map.current.setZoom(zoom);\n        }\n    },[zoom]);\n\n    const componentStyle = Object.assign({width: '100%', height:'600px'}, style || {});\n\n   return (\n    <div id={MAP_VIEW_ID} style={componentStyle} className={className}></div>\n   );\n};\nexport default MapPicker;"],"names":["loadScript","src","id","script","document","createElement","setAttribute","querySelector","appendChild","Promise","resolve","onload","isValidLocation","location","Math","abs","lat","lng","GOOGLE_SCRIPT_URL","MAP_VIEW_ID","random","toString","substr","MapPicker","apiKey","defaultLocation","zoom","onChangeLocation","onChangeZoom","style","className","map","React","useRef","marker","handleChangeLocation","currentLocation","current","getPosition","handleChangeZoom","getZoom","loadMap","Google","window","google","validLocation","maps","Map","getElementById","center","Marker","position","draggable","event","addListener","setPosition","clickedLocation","latLng","useEffect","then","setCenter","setZoom","componentStyle","Object","assign","width","height"],"mappings":"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"}